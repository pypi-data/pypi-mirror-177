---

extra_includes:
- "frc/kinematics/SwerveModuleState.h"

classes:
  SwerveDrivePoseEstimator:
    shared_ptr: false
    doc: |
      This class wraps an Unscented Kalman Filter to fuse latency-compensated
      vision measurements with swerve drive encoder velocity measurements. It will
      correct for noisy measurements and encoder drift. It is intended to be an
      easy but more accurate drop-in for :class:`SwerveDriveOdometry`.

      :meth:`update` should be called every robot loop. If your loops are faster or
      slower than the default of 0.02s, then you should change the nominal delta
      time by specifying it in the constructor.

      :meth:`addVisionMeasurement` can be called as infrequently as you want; if you
      never call it, then this class will behave mostly like regular encoder
      odometry.

      The state-space system used internally has the following states (x), inputs
      (u), and outputs (y):

      :math:`x = [x, y, \theta]^T` in the field-coordinate system
      containing x position, y position, and heading.

      :math:`u = [v_x, v_y, \omega]^T` containing x velocity, y velocity,
      and angular velocity in the field-coordinate system.

      :math:`y = [x, y, \theta]^T` from vision containing x position, y
      position, and heading; or :math:`y = [theta]^T` containing gyro
      heading.
    template_params:
    - size_t NumModules
    constants:
    - SwerveDrivePoseEstimator<NumModules>::States
    - SwerveDrivePoseEstimator<NumModules>::Inputs
    - SwerveDrivePoseEstimator<NumModules>::Outputs
    attributes:
      States:
      Inputs:
      Outputs:
    methods:
      SwerveDrivePoseEstimator:
        param_override:
          nominalDt:
            default: 0.02_s
      ResetPosition:
      GetEstimatedPosition:
      SetVisionMeasurementStdDevs:
      AddVisionMeasurement:
        overloads:
          Pose2d&, units::second_t:
          Pose2d&, units::second_t, wpi::array<double, 3>&:
      Update:
      UpdateWithTime:

templates:
  SwerveDrive2PoseEstimator:
    qualname: frc::SwerveDrivePoseEstimator
    subpackage: estimator
    params:
    - 2
  SwerveDrive3PoseEstimator:
    qualname: frc::SwerveDrivePoseEstimator
    subpackage: estimator
    params:
    - 3
  SwerveDrive4PoseEstimator:
    qualname: frc::SwerveDrivePoseEstimator
    subpackage: estimator
    params:
    - 4
  SwerveDrive6PoseEstimator:
    qualname: frc::SwerveDrivePoseEstimator
    subpackage: estimator
    params:
    - 6
