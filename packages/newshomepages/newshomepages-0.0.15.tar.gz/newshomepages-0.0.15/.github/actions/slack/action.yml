name: Slack
description: Post an archive artifact to Slack

inputs:
  handle:
    description: The site handle to post
    required: true
  webhook-url:
    description: The Slack webhook to post
    required: true

runs:
  using: "composite"
  steps:
    - id: checkout
      name: Checkout
      uses: actions/checkout@v3

    - id: install
      name: Install Python dependencies
      uses: ./.github/actions/install

    - uses: actions/download-artifact@v3
      with:
        name: archive
        path: ./_input

    - id: send-slack
      name: Post to Slack
      run: pipenv run python -m newshomepages.slack ./_input/${{ inputs.handle }}.json
      shell: bash
      env:
        SLACK_WEBHOOK_URL: ${{ inputs.webhook-url }}
