(self.webpackChunkcustom_onnx=self.webpackChunkcustom_onnx||[]).push([[568],{568:function(e,t,n){"use strict";var s=this&&this.__createBinding||(Object.create?function(e,t,n,s){void 0===s&&(s=n),Object.defineProperty(e,s,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,s){void 0===s&&(s=n),e[s]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||s(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(657),t),i(n(367),t)},657:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODULE_NAME=t.MODULE_VERSION=void 0;const s=n(147);t.MODULE_VERSION=s.version,t.MODULE_NAME=s.name},367:function(e,t,n){"use strict";var s=this&&this.__awaiter||function(e,t,n,s){return new(n||(n=Promise))((function(i,a){function o(e){try{r(s.next(e))}catch(e){a(e)}}function l(e){try{r(s.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,l)}r((s=s.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ExampleView=t.ExampleModel=void 0;const i=n(829),a=n(657);n(204);const o=n(674),l=n(674),r=n(822),u=n(825);class d extends i.DOMWidgetModel{defaults(){return Object.assign(Object.assign({},super.defaults()),{_model_name:d.model_name,_model_module:d.model_module,_model_module_version:d.model_module_version,_view_name:d.view_name,_view_module:d.view_module,_view_module_version:d.view_module_version,value:"Hello World",model_path:"./model.onnx",wasm_path:"./wasm",initialized:!1,done:!1,image_data:null,array:u([]),array_out:u([])})}initialize(e,t){super.initialize(e,t),console.log("custom onnx model init"),this.on("change:image_data",this.onImageData.bind(this)),this.on("change:array",this.onChangeArray.bind(this)),this.session=void 0,l.env.wasm.wasmPaths=this.get("wasm_path");const n=this.get("model_path");console.log("model_path",n),this.create(n),console.log("session",this.session)}create(e){return s(this,void 0,void 0,(function*(){try{l.env.wasm.numThreads=2,this.session=yield o.InferenceSession.create(e,{executionProviders:["wasm"]}),console.log("create session",this.session),this.set("initialized",!0),this.save_changes()}catch(e){console.error(e)}}))}run_model(e,t){return s(this,void 0,void 0,(function*(){console.log("run_model with",this.session,t);var n={};const s=new o.Tensor("float32",e,t);n[this.session.inputNames[0]]=s;const i=yield this.session.run(n),a=i[this.session.outputNames[0]].dims,l=i[this.session.outputNames[0]].data,r=u(l,a);console.log("ndarray out",r),this.set("array_out",r),this.set("done",!0),this.save_changes(this.callbacks())}))}onChangeRun(){}onChangeArray(){console.log("onArray"),this.set("done",!1),this.save_changes(this.callbacks());const e=this.get("array");console.log("array_data",e.data,e.shape),this.run_model(e.data,e.shape),console.log("fin")}onImageData(){console.log("onImageData");const e=this.get("image_data"),t=Float32Array.from(e);console.log("data float",t)}}t.ExampleModel=d,d.serializers=Object.assign(Object.assign({},i.DOMWidgetModel.serializers),{image_data:{serialize:function(e){return new DataView(e.buffer.slice(0))},deserialize:function(e){return null===e?null:new Uint8ClampedArray(e.buffer)}},array:r.compressed_array_serialization,array_out:r.compressed_array_serialization}),d.model_name="ExampleModel",d.model_module=a.MODULE_NAME,d.model_module_version=a.MODULE_VERSION,d.view_name="ExampleView",d.view_module=a.MODULE_NAME,d.view_module_version=a.MODULE_VERSION;class c extends i.DOMWidgetView{render(){this.el.classList.add("custom-widget"),this.value_changed(),this.model.on("change:value",this.value_changed,this)}value_changed(){this.el.textContent=this.model.get("value"),console.log("on value changed",this.model.get("array_out"))}}t.ExampleView=c},889:(e,t,n)=>{(t=n(645)(!1)).push([e.id,".custom-widget {\n  background-color: lightseagreen;\n  padding: 0px 2px;\n}\n",""]),e.exports=t},204:(e,t,n)=>{var s=n(379),i=n(889);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.id,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},147:e=>{"use strict";e.exports=JSON.parse('{"name":"custom_onnx","version":"0.1.1","description":"A Custom Jupyter Widget Library","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"homepage":"https://github.com/myorg/custom_onnx","bugs":{"url":"https://github.com/myorg/custom_onnx/issues"},"license":"BSD-3-Clause","author":{"name":"nallezard","email":"nicolas.allezard@cea.fr"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/myorg/custom_onnx"},"scripts":{"build":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension:dev","build:prod":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc","build:nbextension":"webpack","clean":"yarn run clean:lib && yarn run clean:nbextension && yarn run clean:labextension","clean:lib":"rimraf lib","clean:labextension":"rimraf custom_onnx/labextension","clean:nbextension":"rimraf custom_onnx/nbextension/static/index.js","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","prepack":"yarn run build:lib","test":"jest","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch ."},"dependencies":{"@jupyter-widgets/base":"^1.1.10 || ^2 || ^3 || ^4 || ^5 || ^6","jupyterlab-datawidgets":"^7.1.2","ndarray":"^1.0.19","onnxruntime-web":"^1.8.0"},"devDependencies":{"@babel/core":"^7.5.0","@babel/preset-env":"^7.5.0","@jupyter-widgets/base-manager":"^1.0.2","@jupyterlab/builder":"^3.0.0","@lumino/application":"^1.6.0","@lumino/widgets":"^1.6.0","@types/jest":"^26.0.0","@types/ndarray":"^1.0.11","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","copy-webpack-plugin":"^8.1.1","css-loader":"^3.2.0","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^1.1.3","style-loader":"^1.0.0","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.61.0","webpack-cli":"^4.0.0"},"jupyterlab":{"extension":"lib/plugin","outputDir":"custom_onnx/labextension/","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);