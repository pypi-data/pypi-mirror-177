(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const s of t.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?t.credentials="include":e.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(e){if(e.ep)return;e.ep=!0;const t=r(e);fetch(e.href,t)}})();const l=500,u=document.body.querySelector("#title"),f=document.body.querySelector("article"),c=async()=>await(await fetch(`${location.origin}/api/info`)).json(),d=async function*(){const i=`ws://${location.host}/ws`;let n=()=>{},r=new WebSocket(i);const o=()=>{r.onmessage=({data:e})=>n(e),r.onclose=async()=>{await new Promise(e=>setTimeout(e,l)),r=new WebSocket(i),o()}};for(o();;)yield new Promise(t=>n=t)},a=async i=>{const n=await(await fetch(`${location.origin}/api/markdown`)).text();f.innerHTML=n,await new Promise(t=>requestAnimationFrame(t));const r=document.body.querySelectorAll('[diff="True"]'),[o,...e]=r;i&&o&&o.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})},m=async()=>{const i=await c();document.title=i.title,u.textContent=i.title;const n=async()=>{for(;;)try{for await(const o of d())await a(i.follow)}catch(o){console.error(o)}},r=async()=>{let o;for(;;){try{const e=await c();e.sha!==o&&(await a(e.follow),o=e.sha)}catch(e){console.error(e)}await new Promise(e=>setTimeout(e,l))}};await Promise.all([n(),r()])};m();
