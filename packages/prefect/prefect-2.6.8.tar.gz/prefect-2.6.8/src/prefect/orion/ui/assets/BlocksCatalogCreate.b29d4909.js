import{u as w,R as N,r as V,I as T,aK as $,d as q,a as D,e as p,g as O,j as r,o as d,h as S,w as g,i as F,aL as J,aM as L,aN as M,q as Q,aO as W,s as v,ab as A,aP as j,G as E}from"./index.f501c99b.js";import{u as G}from"./useRouteParam.2c81f519.js";import{u as R}from"./useSubscriptionWithDependencies.ac8b808f.js";import{u as H}from"./usePageTitle.5cb2ef88.js";function I(o,e=""){var f;const u=w(),n=N(),k=C(e,(f=B(n,o))!=null?f:e),c=V(k),b=T(c,(i,s)=>{K(i,s)||u.push({query:{...n.query,[o]:c.value}})}),t=T(n,(i,s)=>{var y,a;const h=(y=B(i,o))!=null?y:e,_=(a=B(s,o))!=null?a:e,m=C(_,h);m!==c.value&&(c.value=m)},{deep:!0});return $(()=>{b(),t()}),c}function B({query:o},e){return o[e]}function C(o,e){return Array.isArray(o)&&!Array.isArray(e)?[e]:typeof o=="string"&&Array.isArray(e)?e[0]:e}function K(o,e){return JSON.stringify(o)===JSON.stringify(e)}const Z=q({__name:"BlocksCatalogCreate",setup(o){const e=D(),u=w(),n=I("redirect"),k=G("blockTypeSlug"),c=p(()=>k.value?[k.value]:null),b=R(e.blockTypes.getBlockTypeBySlug,c),t=p(()=>b.response),f=p(()=>t.value?[t.value.id]:null),i=R(e.blockSchemas.getBlockSchemaForBlockType,f),s=p(()=>i.response);function h(a){e.blockDocuments.createBlockDocument(a).then(({id:l})=>m(l)).catch(l=>{A("Failed to create block","error"),console.error(l)})}function _(){u.back()}function m(a){if(A("Block created successfully","success"),n.value){const l=u.resolve(j(n.value));u.push(l);return}u.push(E.block(a))}const y=p(()=>t.value?`Create ${t.value.name} Block`:"Create Block");return H(y),(a,l)=>{const P=O("p-layout-default");return r(t)?(d(),S(P,{key:0,class:"blocks-catalog-create"},{header:g(()=>[F(r(J),{"block-type":r(t)},null,8,["block-type"])]),default:g(()=>[r(t)?(d(),S(r(L),{key:0,"block-type":r(t)},{default:g(()=>[r(s)?(d(),S(r(M),Q({key:0,key:r(s).id,"block-schema":r(s)},W({submit:h,cancel:_})),null,16,["block-schema"])):v("",!0)]),_:1},8,["block-type"])):v("",!0)]),_:1})):v("",!0)}}});export{Z as default};
