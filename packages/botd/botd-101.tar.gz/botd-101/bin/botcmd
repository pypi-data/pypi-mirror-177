#!/usr/bin/env python3
# This file is placed in the Public Domain.
# pylint: disable=C0115,C0116,C0413


"24/7 channel daemon"


__version__ = "101"


import os
import sys


from bot.handler import Handler, parse
from bot.object import Wd
from bot.handler import command, scan
from bot.run import Cfg
from bot.irc import Config


from bot import cmds, irc, rss


Config.channel = "#botd"
Config.nick = "botd"
Config.username = "botd"
Config.realname = "24/7 channel daemon"


Wd.workdir = "/var/lib/botd/"


scan(cmds)
scan(irc)
scan(rss)


class CLI(Handler):

    @staticmethod
    def announce(txt):
        CLI.raw(txt)

    @staticmethod
    def raw(txt):
        cprint(txt)

    def say(self, channel, txt):
        self.raw(txt)


def cprint(txt):
    print(txt)
    sys.stdout.flush()


def main():
    parse(' '.join(sys.argv[1:]))
    cli = CLI()
    evt = command(cli, Cfg.otxt)
    evt.wait()


main()
